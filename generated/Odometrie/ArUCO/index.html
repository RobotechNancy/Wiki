<!DOCTYPE html>

<html lang="fr">
	<head>
		<meta charset="utf-8">
		<title>Wiki Robotech Nancy - Marqueurs ArUCO</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="Documentation sur les marqueurs ArUCO">

		<link rel="stylesheet" href="http://127.0.0.1:8000/static/style.css">
		<link rel="apple-touch-icon" href="http://127.0.0.1:8000/static/images/icons/logo.webp">
		<link rel="icon" type="image/webp" href="http://127.0.0.1:8000/static/images/icons/logo.webp">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700&display=swap">
	</head>

	<body>
		<header>
			<h1>
				<a href="http://127.0.0.1:8000/">
					<img src="http://127.0.0.1:8000/static/images/icons/logo.webp" width="40" height="40" alt="Logo Robotech Nancy">
					<span>Wiki Robotech Nancy</span>
				</a>
				<button type="button" class="open-nav" aria-label="Ouvrir la navigation" onclick="document.body.classList.toggle('nav-open')"></button>
			</h1>

			<nav>
				<div>
					
    

    <a href="http://127.0.0.1:8000/Cartes/">Cartes utilisées</a>
    

    <a href="http://127.0.0.1:8000/Wiki/">Modifier ce wiki</a>
    

    <details>
        <summary>Build avec CMake</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/CMake/Installation/">Installer CMake</a>
    

    <a href="http://127.0.0.1:8000/CMake/Executable/">Créer un exécutable</a>
    

    <a href="http://127.0.0.1:8000/CMake/Lier/">Lier des librairies</a>
    

    <a href="http://127.0.0.1:8000/CMake/Librairie/">Créer une librairie</a>
    

        </div>
    </details>
    

    <details>
        <summary>Projets STM32</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/STM32/Installation/">Installation</a>
    

    <a href="http://127.0.0.1:8000/STM32/Projet/">Créer un projet</a>
    

    <a href="http://127.0.0.1:8000/STM32/CubeMX/">Configurer une carte</a>
    

        </div>
    </details>
    

    <details>
        <summary>Bus CAN</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/CAN/Principe/">Principe</a>
    

    <a href="http://127.0.0.1:8000/CAN/Raspberry/">Librairie Raspberry</a>
    

    <a href="http://127.0.0.1:8000/CAN/STM32/">Librairie STM32</a>
    

    <details>
        <summary>Implémentation</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/CAN/Implementation/Format/">Format des trames</a>
    

    <a href="http://127.0.0.1:8000/CAN/Implementation/Librairie/">Initialisation</a>
    

    <a href="http://127.0.0.1:8000/CAN/Implementation/Reception/">Réception de données</a>
    

    <a href="http://127.0.0.1:8000/CAN/Implementation/Envoi/">Envoi de données</a>
    

        </div>
    </details>
    

        </div>
    </details>
    

    <details>
        <summary>Modules XBee</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/XBee/Principe/">Principe</a>
    

    <a href="http://127.0.0.1:8000/XBee/Librairie/">Utiliser la librairie</a>
    

    <details>
        <summary>Implémentation</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/XBee/Implementation/Format/">Format des trames</a>
    

    <a href="http://127.0.0.1:8000/XBee/Implementation/Initialisation/">Initialisation</a>
    

    <a href="http://127.0.0.1:8000/XBee/Implementation/Reception/">Réception de données</a>
    

    <a href="http://127.0.0.1:8000/XBee/Implementation/Envoi/">Envoi de données</a>
    

        </div>
    </details>
    

        </div>
    </details>
    

    <details>
        <summary>Odométrie</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/Odometrie/ArUCO/">Marqueurs ArUCO</a>
    

    <a href="http://127.0.0.1:8000/Odometrie/Optique/">Capteur optique</a>
    

        </div>
    </details>
    

    <details>
        <summary>Signaux PWM</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/PWM/STM32/">STM32</a>
    

    <details>
        <summary>PCA9685</summary>
        <div>
            
    <a href="http://127.0.0.1:8000/PWM/PCA9685/Librairie/">Utiliser la librairie</a>
    

    <a href="http://127.0.0.1:8000/PWM/PCA9685/Implementation/">Implémentation</a>
    

        </div>
    </details>
    

        </div>
    </details>
    

				</div>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>Odometrie/ArUCO</h2>
				<h3 class="no-anchor">Marqueurs ArUCO</h3>
			</div>
			<article class="content">
				<p>Des tags ArUCO (en rouge) sont placés sur le plateau et les éléments de jeu. Pour situer ces tags, des modules sont placés sur des balises (en bleu ou jaune) :
<img alt="Terrain de jeu" loading="lazy" src="http://127.0.0.1:8000/static/images/aruco/playground.webp" /></p>
<p>Chaque balise est montée d'un module contenant :</p>
<ul>
<li>Une caméra</li>
<li>Un module <a href="http://127.0.0.1:8000/communication/XBee/principe">XBee</a> (S1 Pro)</li>
<li>Une batterie LiFePO4</li>
<li>Un Raspberry Pi Zero (<a href="https://opencv.org/">OpenCV</a> et <a href="https://github.com/opencv/opencv_contrib">OpenCV contrib</a>)</li>
</ul>
<h3>Installation</h3>
<p>Pour utiliser la <a href="https://github.com/RobotechNancy/Odometrie/tree/master/ArUCO">librairie ArUCO</a>, il faut installer :</p>
<ul>
<li>La librairie custom <a href="http://127.0.0.1:8000/XBee/Librairie">XBee</a></li>
<li>La librairie OpenCV avec OpenCV contrib :</li>
</ul>
<div class="codehilite"><pre tabindex='0'><span></span><code><span class="c1"># svn (subversion) permet de ne télécharger que les modules opencv nécessaires</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>subversion<span class="w"> </span>libapache2-mod-svn<span class="w"> </span>cmake

git<span class="w"> </span>clone<span class="w"> </span>https://github.com/opencv/opencv.git
mkdir<span class="w"> </span>opencv/build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>opencv/build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>modules

svn<span class="w"> </span><span class="nb">export</span><span class="w"> </span>https://github.com/opencv/opencv_contrib/trunk/modules/aruco
mv<span class="w"> </span>aruco<span class="w"> </span>modules

cmake<span class="w"> </span>-DOPENCV_EXTRA_MODULES_PATH<span class="o">=</span>./modules<span class="w"> </span>..
sudo<span class="w"> </span>make<span class="w"> </span>install<span class="w"> </span>-j<span class="k">$(</span>nproc<span class="k">)</span>
</code></pre></div>

<blockquote>
<p class="quote quote-WARNING">Le processus d'installation peut prendre plusieures heures sur une Raspberry Pi.
Il est aussi possible de cross-compiler OpenCV (non testé).</p>
</blockquote>
<h3>Calibration</h3>
<p>Pour avoir une meilleure détection, il est nécessaire de calibrer la caméra :</p>
<ul>
<li>Définir les paramètres dans <code>data/config.yml</code></li>
<li>Générer une grille ArUCO avec <code>./ArUCO board</code></li>
<li>Démarrer la calibration avec <code>./ArUCO calibrate</code></li>
<li>Prendre plusieurs point de vue avec <code>c</code></li>
<li>Calculer les paramètres en appuyant <code>ECHAP</code></li>
</ul>
<p>Si tout s'est bien passé, un fichier <code>data/camera_params.yml</code> a été créé contenant les paramètres de la caméra (matrice de projection, distorsion, etc...).</p>
<h3>Utilisation</h3>
<p><code>./ArUCO estimate</code> permet de lancer le script de détection et d'estimation de la position des tags ArUCO.
Les paramètres sont repris de <code>data/camera_params.yml</code> et <code>data/config.yml</code> et les positions sont données par rapport à un tag de référence (<code>ref_marker_id</code>).</p>
<p style="text-align: center"><img alt="ArUCO Estimation" loading="lazy" src="http://127.0.0.1:8000/static/images/aruco/estimation.webp" style="display: inline-block;" />
<img alt="ArUCO AR" loading="lazy" src="http://127.0.0.1:8000/static/images/aruco/AR.webp" style="display: inline-block;" /></p>
			</article>
		</section>

		<script src="http://127.0.0.1:8000/static/script.js"></script>
	</body>
</html>